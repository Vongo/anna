<!doctype html>
<html>
  <head>
  <title>Anna</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <style>body { max-width: 500px; margin: auto; padding: 1em; background: black; color: #fff; font: 16px/1.6 menlo, monospace; }</style>
  </head>
  <body>
  <h1>WWAS : What Would Anna Say ?</h1>
  <table>
    <tr>
      <td colspan=2>
        <h3> Anna's opinion </h3>
      </td>
      <td>
        <h3> Category </h3>
      </td>
    </tr>
    <tr>
      <td>
        <p><b>Hi, {{ user }} !</b></p>
      </td>
      <td colspan=2>
        <br/>
      </td>
    </tr>
    <tr>
      <td>
        <p>You say : <input id="in" /></p>
        <pre id="out"></pre>
      </td>
      <td>
        &nbsp&nbsp&nbsp&nbsp
      </td>
      <td>
        <select>
          <option value="Action">Action</option>
          <option value="Drama">Drama</option>
          <option value="Comedy">Comedy</option>
          <option value="Documentary">Documentary</option>
        </select> 
      </td>
    </tr>
  </table>
  <script>
  function sse() {
    var source = new EventSource('/stream');
    var out = document.getElementById('out');
    source.onmessage = function(e) {
      // XSS in chat is fun
      out.innerHTML =  e.data + '\n' + out.innerHTML;
    };
  }
  $('#in').keyup(function(e){
      if (e.keyCode == 13) {
        $.post('/post', {'message': $(this).val()});
        $(this).val('');
        }
      });
  sse();
  </script>
  </body>
</html>
